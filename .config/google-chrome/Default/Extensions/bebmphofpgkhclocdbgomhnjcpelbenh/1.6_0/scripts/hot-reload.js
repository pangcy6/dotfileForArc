const filesInDirectory=e=>new Promise((r=>e.createReader().readEntries((e=>Promise.all(e.filter((e=>"."!==e.name[0])).map((e=>e.isDirectory?filesInDirectory(e):new Promise((r=>e.file(r)))))).then((e=>[].concat(...e))).then(r))))),timestampForFilesInDirectory=e=>filesInDirectory(e).then((e=>e.map((e=>e.name+e.lastModifiedDate)).join())),reload=()=>{chrome.tabs.query({active:!0,currentWindow:!0},(e=>{e[0]&&chrome.tabs.reload(e[0].id),chrome.runtime.reload()}))},watchChanges=(e,r)=>{timestampForFilesInDirectory(e).then((t=>{r&&r!==t?chrome.tabs.query({active:!0,currentWindow:!0},(e=>{e[0]&&chrome.tabs.reload(e[0].id),chrome.runtime.reload()})):setTimeout((()=>watchChanges(e,t)),1e3)}))};chrome.management.getSelf((e=>{"development"===e.installType&&chrome.runtime.getPackageDirectoryEntry((e=>watchChanges(e)))}));