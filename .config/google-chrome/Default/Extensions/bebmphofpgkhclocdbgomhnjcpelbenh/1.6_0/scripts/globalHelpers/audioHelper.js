class AudioUtils{constructor(t){this.context=t}speechWord(t,e){const n=`https://translate.googleapis.com/translate_tts?client=gtx&ie=UTF-8&tl=${e}&q=${encodeURI(t)}`;this.context.audioElement.setAttribute("src",n),this.context.audioElement.play()}_makeSentencesFromText(t){const e=t.split(" "),n=[];let s="";return e.forEach(((t,c)=>{const i=`${s} ${t}`;i.length<200?(s=i,c===e.length-1&&n.push(s)):(n.push(s),s=t,c===e.length-1&&n.push(t))})),n}_createSpeechLinks(t,e){const n=[];return t.forEach((t=>{const s=`https://translate.googleapis.com/translate_tts?client=gtx&ie=UTF-8&tl=${e}&q=${encodeURI(t)}`;n.push(s)})),n}speechText(t){this.context.audioElement.setAttribute("src","");const{text:e,lang:n}=t,s=this._makeSentencesFromText(e),c=this._createSpeechLinks(s,n);this.context.audioElement.onended=()=>{const t=c;t[++i]&&(this.context.audioElement.setAttribute("src",t[i]),this.context.audioElement.play())};let i=0;const o=c[0];this.context.audioElement.setAttribute("src",o),this.context.audioElement.play()}speechSentences(t){this.context.audioElement.onended=()=>{const n=this.context.speechLinks[t];n[++e]&&(this.context.audioElement.setAttribute("src",n[e]),this.context.audioElement.play())};let e=0;const n=this.context.speechLinks[t][0];this.context.audioElement.setAttribute("src",n),this.context.audioElement.play()}createSentacesSpeechLinks(t,e={}){let n=[];const s=e.lang_from||this.context.translatedLang,c=e.lang_to||this.context.storage.tl;t.sentences&&(t=t.sentences);let i=t.length;if(i&&1==i)n=t;else if(i)for(let e=0;e<i;e++)n=n.concat(t[e]);if(1===n.length&&(n=n[0]),!n.length){let t=n;if(t.translit||t.src_translit)return;return this.createSentenceParts(t.orig,s,"originLangLinks"),void this.createSentenceParts(t.trans,c,"targetLangLinks")}n.forEach((t=>{t.translit||t.src_translit||(this.createSentenceParts(t.orig,s,"originLangLinks"),this.createSentenceParts(t.trans,c,"targetLangLinks"))}))}createSentenceParts(t,e,n){let s="";if(t.length>200){const c=t.match(/.*?[\.\s]+?/g);for(let t=0;t<c.length;t++)if(s.length+c[t].length<200)s+=c[t];else{const t=`https://translate.googleapis.com/translate_tts?client=gtx&ie=UTF-8&tl=${e}&q=${encodeURI(s)}`;this.context.speechLinks[n].push(t),s=""}s.length&&this.context.speechLinks[n].push(`https://translate.googleapis.com/translate_tts?client=gtx&ie=UTF-8&tl=${e}&q=${encodeURI(s)}`)}else this.context.speechLinks[n].push(`https://translate.googleapis.com/translate_tts?client=gtx&ie=UTF-8&tl=${e}&q=${encodeURI(t)}`)}stopSpeech(){this.context.audioElement.pause(),this.context.audioElement.currentTime=0}}