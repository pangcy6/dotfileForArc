class Translation{constructor(e){this.Utils=new Config,this.settings=e}save(e){let{action:a,mode:n}=e;this.popup_mode="blue"===a?"blue":"red"===a?"red":"aquamarine"===a?"aquamarine":"green"===a?"green":"violet"===a?"violet":"pink"===a?"pink":"yellow"===a?"yellow":"gray"===a?"gray":"black"===a?"black":n;var l=document.getElementById("icon-trans"),t=document.getElementById("double-click");if("iconTrans"===a)if(l.setAttribute("checked",l.checked),$("#icon-trans").prop("checked")){let e=this.popup_mode;$("#icon-trans").css("background-image",`url('chrome-extension://${chrome.runtime.id}/images/circle_${e}.svg')`)}else $("#icon-trans").css("background-image",`url('chrome-extension://${chrome.runtime.id}/images/circle_noactive.svg')`);else if("doubleClick"===a)if(t.setAttribute("checked",t.checked),$("#double-click").prop("checked")){let e=this.popup_mode;$("#double-click").css("background-image",`url('chrome-extension://${chrome.runtime.id}/images/circle_${e}.svg')`)}else $("#double-click").css("background-image",`url('chrome-extension://${chrome.runtime.id}/images/circle_noactive.svg')`);let i=t.getAttribute("checked"),s=l.getAttribute("checked");this.IsDoubleClick="checked"===i||"true"===i?"true":"false",this.IsIconTrans="checked"===s||"true"===s?"true":"false",chrome.storage.local.set({vm:$("#view-mode").val(),double_click:"double_click_"+this.IsDoubleClick,icon_trans:"icon_trans_"+this.IsIconTrans,popup_mode:this.popup_mode}),$("#notification").attr("class","notification is-warning"),$("#message").html(chrome.i18n.getMessage("automatic_save")),setTimeout((function(){$("#message").html(),$("#notification").attr("class","hide")}),2e3)}getTranslateToLanguage(){return this.Utils.config.tl?this.Utils.config.tl:this.normalizeLanguageCode(window.navigator.language)}supportedLocale(e){return-1!==["ar","bg","ca","cs","da","de","el","en","en-GB","en-US","es","es-419","et","fi","fil","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nl","no","pl","pt-BR","pt-PT","ro","ru","sk","sl","sr","sv","th","tl","tr","uk","vi","zh-CN","zh-TW"].indexOf(e)}normalizeLanguageCode(e){return"zh-tw"===e.toLowerCase()?"zh-TW":"zh-cn"===e.toLowerCase()?"zh-CN":e.length>=2&&this.supportedLocale(e)?e.substr(0,2):"en"}setSupportedSelectOptions(e,a){const n=document.querySelector(e),l=a+"_false",t={[a+"_true"]:chrome.i18n.getMessage("double_click_true"),[l]:chrome.i18n.getMessage("double_click_false")};this.populateSelect(n,t),chrome.storage.local.get(a,(e=>{this.setSelectedValue(n,e[a])}))}loadSupportedDblClickOptions(){this.setSupportedSelectOptions("#double-click","double_click")}loadSupportedIconTransOptions(){this.setSupportedSelectOptions("#icon-trans","icon_trans")}loadTranslateLanguages(){chrome.storage.local.get((e=>{let{popup_mode:a}=e;const{languagesList:n}=e;this.renderLanguagesList(n,a),this.renderAddLAnguageBtn(a)}))}renderLanguagesList(e,a){let n=this.defineCurrentColor(a);const l=document.querySelector(".selected-languages");l.innerHTML="",e.forEach((e=>{const{shortName:n,fullName:t}=e,i=`\n                <li class="selected-languages__item ${a}" data-short="${n}">\n                    <span class="selected-languages__fullName">${t}</span>\n                    <span class="selected-languages__delete"></span>\n                </li>\n            `;l.insertAdjacentHTML("beforeend",i)})),$(".selected-languages__delete").css("background-image",`url('chrome-extension://${chrome.runtime.id}/images/${a}_close.svg')`),$(".selected-languages__item").css("background",n),"gray"===a&&($(".selected-languages").css("background-color","#192330"),$(".selected-languages__fullName").css("color","#7F94A0")),"black"===a&&($(".selected-languages").css("background-color","#1A1A1A"),$(".selected-languages__fullName").css("color","#919295"))}defineCurrentColor(e){let a;return"aquamarine"===e?a="#EDF4F3":"blue"===e?a="#EDF2F7":"green"===e?a="#F5F8F7":"violet"===e?a="#EBEBF2":"pink"===e?a="#EAECF3":"yellow"===e?a="#F6F6F6":"red"===e?a="#F4EAEB":"gray"===e?a="#21303F":"black"===e&&(a="#000"),a}renderAddLAnguageBtn(e){const a=this,n=`\n        <button class="btn-add-lang btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false"></button>\n        <ul class="dropdown-menu ${e} languageSelector">\n            <li><a class="dropdown-item" href="#" data-lang='af'>Afrikaans</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='sq'>Albanian - shqipe</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='ar'>Arabic - ‎‫العربية‬‎</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='hy'>Armenian - Հայերէն</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='az'>Azerbaijani - azərbaycanca</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='eu'>Basque - euskara</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='be'>Belarusian - беларуская</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='bn'>Bengali - বাংলা</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='bg'>Bulgarian - български</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='ca'>Catalan - català</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='zh-CN'>Chinese - 中文（简体中文）</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='zh-TW'>Chinese - 中文 (繁體中文)</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='hr'>Croatian - hrvatski</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='cs'>Czech - čeština</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='da'>Danish - dansk</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='nl'>Dutch - Nederlands</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='en'>English</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='eo'>Esperanto - esperanto</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='et'>Estonian - eesti</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='tl'>Filipino</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='fi'>Finnish - suomi</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='fr'>French - français</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='gl'>Galician - galego</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='ka'>Georgian - ქართული</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='de'>German - Deutsch</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='el'>Greek - Ελληνικά</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='gu'>Gujarati - ગુજરાતી</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='ht'>Haitian Creole - kreyòl ayisyen</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='iw'>Hebrew - ‎‫עברית‬‎</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='hi'>Hindi - हिन्दी</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='hu'>Hungarian - magyar</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='is'>Icelandic - íslenska</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='id'>Indonesian - Bahasa Indonesia</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='ga'>Irish - Gaeilge</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='it'>Italian - italiano</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='ja'>Japanese - 日本語</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='kn'>Kannada - ಕನ್ನಡ</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='ko'>Korean - 한국어</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='la'>Latin - Lingua Latina</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='lv'>Latvian - latviešu</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='lt'>Lithuanian - lietuvių</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='mk'>Macedonian - македонски</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='ms'>Malay - Bahasa Melayu</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='mt'>Maltese - Malti</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='no'>Norwegian - norsk</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='fa'>Persian - ‎‫فارسی‬‎</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='pl'>Polish - polski</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='pt'>Portuguese - português</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='ro'>Romanian - română</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='ru'>Russian - русский</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='sr'>Serbian - Српски</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='sk'>Slovak - slovenčina</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='sl'>Slovenian - slovenščina</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='es'>Spanish - español</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='sw'>Swahili - Kiswahili</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='sv'>Swedish - svenska</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='ta'>Tamil - தமிழ்</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='te'>Telugu - తెలుగు</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='th'>Thai - ไทย</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='tr'>Turkish - Türkçe</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='uk'>Ukrainian - українська</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='ur'>Urdu - ‎‫اردو‬‎</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='vi'>Vietnamese - Tiếng Việt</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='cy'>Welsh - Cymraeg</a></li>\n            <li><a class="dropdown-item" href="#" data-lang='yi'>Yiddish - יידיש</a></li>\n        </ul>\n        `;document.querySelector(".selected-languages").insertAdjacentHTML("beforeend",n),$(".languageSelector .dropdown-item").click((function(){a.settings.onLanguageAdded($(this).data("lang"))})),"gray"!==e&&"black"!==e||$(".btn-add-lang").css("background-image",`url('chrome-extension://${chrome.runtime.id}/images/add_language_image_${e}.svg')`)}createContextMenu(){chrome.storage.local.get((e=>{chrome.contextMenus.create({title:"translate on",id:"languagesList",contexts:["selection"]},(()=>{const{languagesList:a}=e;if(a.length)a.forEach((e=>{const{fullName:a,shortName:n}=e;this.createContextMenuItem(a,n)}));else{const e=this.getTlFullName(),a=chrome.i18n.getUILanguage();this.createContextMenuItem(e,a)}}))}))}getTlFullName(){const e=chrome.i18n.getUILanguage();let a=null;return LANGUAGES.forEach((n=>{n.short===e&&(a=n.international)})),a}createContextMenuItem(e,a){const n={title:e,id:a,parentId:"languagesList",contexts:["selection"],onclick:this.handleContextMenuClick};chrome.contextMenus.create(n,(()=>{}))}handleContextMenuClick(e){chrome.tabs.query({active:!0,currentWindow:!0},(a=>{const[n]=a;chrome.storage.local.set({tl:e.menuItemId},(()=>{})),chrome.tabs.sendMessage(n.id,{action:"showTranslatePopup",translateTo:e.menuItemId},(()=>{}))}))}openUrl(e,a){chrome.tabs.create({url:e,selected:a})}setSelectedValue(e,a){let n=document.getElementById("double-click"),l=document.getElementById("icon-trans");if("double_click_false"===a)return n.removeAttribute("checked"),void(n.style["background-image"]=`url('chrome-extension://${chrome.runtime.id}/images/circle_noactive.svg')`);if("double_click_true"===a)n.setAttribute("checked","checked");else{if("icon_trans_false"===a)return l.style["background-image"]=`url('chrome-extension://${chrome.runtime.id}/images/circle_noactive.svg')`,void l.removeAttribute("checked");if("icon_trans_true"!==a)return;l.setAttribute("checked","checked")}}populateSelect(e,a){for(let n in a){let l=document.createElement("option");l.value=n,l.textContent=a[n],e.appendChild(l)}return e}changeElementsVisibility(){let e=document.getElementsByTagName("select"),a=document.getElementsByTagName("label");for(let a=0;a<e.length;a++)e[a].className="visible";for(let e=0;e<a.length;e++)a[e].className="visible"}translate(e){let a=e.selectionText,n=Utils.config.vm,l=a.toLowerCase()!==chrome.i18n.getMessage("name").toLowerCase()?"auto":"la";if("tt"!==n){let e="http://translate.google.com/#"+l+"|"+this.getTranslateToLanguage()+"|"+encodeURIComponent(a);this.openUrl(e,"ognt"===n)}}}