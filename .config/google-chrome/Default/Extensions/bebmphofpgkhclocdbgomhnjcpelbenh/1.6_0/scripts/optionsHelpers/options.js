class Settings{constructor(){this.MAX_LANGUAGES_AMOUNT=5,this.storage=null,this.pageTitle=null,this.$allLanguagesSelect=$("#languages"),this.$selectedLanguages=$(".selected-languages"),this.$closePopup=$("#btn_settings_save"),this.handlers=new SettingsHandlers(this),this.translate=new Translation(this),this.run()}onLanguageAdded(e){this.handlers.handleLanguageAdding(e)}run(){this.initStorage().then((()=>{this.setDefaultView(),this.initSupportedOptions(),this.setDocumentTitle(),this.showCheckedOptions(),this.initListeners(),this.translate.changeElementsVisibility()}))}initStorage(){return new Promise(((e,t)=>{chrome.storage.local.get((t=>{this.storage=t,e()}))}))}defineCurrentColor(e){let t;return"aquamarine"===e?t="#02A4B5":"blue"===e?t="#3768F3":"green"===e?t="#6AC172":"violet"===e?t="#5E40B5":"pink"===e?t="#EA61AC":"yellow"===e?t="#FBB352":"red"===e?t="#E95049":"gray"===e?t="#192330":"black"===e&&(t="#000"),t}setDefaultView(){if("gray"===this.storage.popup_mode)$("#lb_translate_to_additional").css("color","#7F93A0"),$("#lb_double-click").css("color","#7F93A0"),$("#lb_icon-trans").css("color","#7F93A0"),$("#content .popup-mode").css("color","#7F93A0"),$(".field .control .form-switch .form-check-input").css("background-color","#121E26"),$(".field .control .form-switch .form-check-input").css("border-color","#121E26"),$(".popup-mode-wrapper").css("background-color","#192330"),$(".wrapper_btn_save").css("background-color","#192330"),$("#btn_settings_save").css("background","#21303F"),$("#btn_settings_save").css("color","#61707A");else if("black"===this.storage.popup_mode)$("#lb_translate_to_additional").css("color","#666"),$("#lb_double-click").css("color","#666"),$("#lb_icon-trans").css("color","#666"),$("#content .popup-mode").css("color","#666"),$(".field .control .form-switch .form-check-input").css("background-color","#000"),$(".field .control .form-switch .form-check-input").css("border-color","#000"),$(".popup-mode-wrapper").css("background-color","#000"),$(".wrapper_btn_save").css("background-color","#1A1A1A"),$("#btn_settings_save").css("background","#000"),$("#btn_settings_save").css("color","#919295");else{let e=this.defineCurrentColor(this.storage.popup_mode);$("#btn_settings_save").css("background",e)}$("#favicon").attr("href",chrome.runtime.getURL(`images/favicons/favicon_${this.storage.popup_mode}.ico`))}initSupportedOptions(){this.translate.loadSupportedDblClickOptions(),this.translate.loadSupportedIconTransOptions(),this.translate.loadTranslateLanguages()}setDocumentTitle(){this.pageTitle=chrome.i18n.getMessage("name")+" - "+chrome.i18n.getMessage("settings"),document.title=this.pageTitle}showCheckedOptions(){$("#link").attr("href",`https://chrome.google.com/webstore/detail/${chrome.runtime.id}`),$("#instruction").html(chrome.i18n.getMessage("instruction")),$("#description").html(chrome.i18n.getMessage("description")),$("#title").html(this.pageTitle),$("#lb_translate_to_additional").html(chrome.i18n.getMessage("translate_to_additional")),$("#lb_view-mode").html(chrome.i18n.getMessage("view_mode")),$("#lb_double-click").html(chrome.i18n.getMessage("double_click")),$("#lb_icon-trans").html(chrome.i18n.getMessage("icon_trans")),$("#btn_settings_save").html(chrome.i18n.getMessage("btn_settings_save"))}initListeners(){this.$allLanguagesSelect.on("change",this.handlers.handleLanguageAdding),this.$closePopup.on("click",this.handlers.closePopup),this.initStorage(),document.querySelector("#double-click").addEventListener("change",function(){this.initStorage().then((()=>{if($("#double-click").prop("checked")){let e=this.storage.popup_mode;$("#double-click").css("background-image",`url('chrome-extension://${chrome.runtime.id}/images/circle_${e}.svg')`)}else $("#double-click").css("background-image",`url('chrome-extension://${chrome.runtime.id}/images/circle_noactive.svg')`);this.translate.save({action:"doubleClick",mode:this.storage.popup_mode})}))}.bind(this)),document.querySelector("#icon-trans").addEventListener("change",function(){this.initStorage().then((()=>{if($("#icon-trans").prop("checked")){let e=this.storage.popup_mode;$("#icon-trans").css("background-image",`url('chrome-extension://${chrome.runtime.id}/images/circle_${e}.svg')`)}else $("#icon-trans").css("background-image",`url('chrome-extension://${chrome.runtime.id}/images/circle_noactive.svg')`);this.translate.save({action:"iconTrans",mode:this.storage.popup_mode})}))}.bind(this)),document.querySelector("#blue").addEventListener("change",function(){this.translate.save({action:"blue"})}.bind(this)),document.querySelector("#green").addEventListener("change",function(){this.translate.save({action:"green"})}.bind(this)),document.querySelector("#red").addEventListener("change",function(){this.translate.save({action:"red"})}.bind(this)),document.querySelector("#aquamarine").addEventListener("change",function(){this.translate.save({action:"aquamarine"})}.bind(this)),document.querySelector("#violet").addEventListener("change",function(){this.translate.save({action:"violet"})}.bind(this)),document.querySelector("#pink").addEventListener("change",function(){this.translate.save({action:"pink"})}.bind(this)),document.querySelector("#yellow").addEventListener("change",function(){this.translate.save({action:"yellow"})}.bind(this)),document.querySelector("#gray").addEventListener("change",function(){this.translate.save({action:"gray"})}.bind(this)),document.querySelector("#black").addEventListener("change",function(){this.translate.save({action:"black"})}.bind(this)),this.$selectedLanguages.on("click",".selected-languages__delete",this.handlers.deleteSelectedLanguage),$("section.section").on("click",".add_additional_lan",(function(){$(".select_for_additional_lan").css({display:"block"})}))}saveToStorage(e,t=(()=>{})){chrome.storage.local.set(e,(()=>{chrome.runtime.lastError||t()}))}}$((function(){new Settings}));